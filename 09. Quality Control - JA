09. Quality Control - JA

#QCStep1
plink --bfile /home/jack/px_prostate_cancer_JA/JA_list --missing -out /home/jack/px_prostate_cancer_JA/QC
PLINK v1.90b4.3 64-bit (9 May 2017)            www.cog-genomics.org/plink/1.9/
(C) 2005-2017 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to /home/jack/px_prostate_cancer_JA/QC.log.
Options in effect:
  --bfile /home/jack/px_prostate_cancer_JA/JA_list
  --missing
  --out /home/jack/px_prostate_cancer_JA/QC

64070 MB RAM detected; reserving 32035 MB for main workspace.
657366 variants loaded from .bim file.
1934 people (1934 males, 0 females) loaded from .fam.
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 1934 founders and 0 nonfounders present.
Calculating allele frequencies... done.
Warning: 3357 het. haploid genotypes present (see
/home/jack/px_prostate_cancer_JA/QC.hh ); many commands treat these as missing.
Total genotyping rate is 0.828028.
--missing: Sample missing data report written to
/home/jack/px_prostate_cancer_JA/QC.imiss, and variant-based missing data
report written to /home/jack/px_prostate_cancer_JA/QC.lmiss.

#QCStep2
plink --bfile /home/jack/px_prostate_cancer_JA/JA_list --geno 0.01 --make-bed --out /home/jack/px_prostate_cancer_JA/QC2
PLINK v1.90b4.3 64-bit (9 May 2017)            www.cog-genomics.org/plink/1.9/
(C) 2005-2017 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to /home/jack/px_prostate_cancer_JA/QC2.log.
Options in effect:
  --bfile /home/jack/px_prostate_cancer_JA/JA_list
  --geno 0.01
  --make-bed
  --out /home/jack/px_prostate_cancer_JA/QC2

64070 MB RAM detected; reserving 32035 MB for main workspace.
657366 variants loaded from .bim file.
1934 people (1934 males, 0 females) loaded from .fam.
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 1934 founders and 0 nonfounders present.
Calculating allele frequencies... done.
Warning: 3357 het. haploid genotypes present (see
/home/jack/px_prostate_cancer_JA/QC2.hh ); many commands treat these as
missing.
Total genotyping rate is 0.828028.
116239 variants removed due to missing genotype data (--geno).
541127 variants and 1934 people pass filters and QC.
Note: No phenotypes present.
--make-bed to /home/jack/px_prostate_cancer_JA/QC2.bed +
/home/jack/px_prostate_cancer_JA/QC2.bim +
/home/jack/px_prostate_cancer_JA/QC2.fam ... done.

#QCStep3
plink --bfile /home/jack/px_prostate_cancer_JA/QC2 --missing --out /home/jack/px_prostate_cancer_JA/QC3
PLINK v1.90b4.3 64-bit (9 May 2017)            www.cog-genomics.org/plink/1.9/
(C) 2005-2017 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to /home/jack/px_prostate_cancer_JA/QC3.log.
Options in effect:
  --bfile /home/jack/px_prostate_cancer_JA/QC2
  --missing
  --out /home/jack/px_prostate_cancer_JA/QC3

64070 MB RAM detected; reserving 32035 MB for main workspace.
541127 variants loaded from .bim file.
1934 people (1934 males, 0 females) loaded from .fam.
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 1934 founders and 0 nonfounders present.
Calculating allele frequencies... done.
Warning: 3118 het. haploid genotypes present (see
/home/jack/px_prostate_cancer_JA/QC3.hh ); many commands treat these as
missing.
Total genotyping rate is 0.999546.
--missing: Sample missing data report written to
/home/jack/px_prostate_cancer_JA/QC3.imiss, and variant-based missing data
report written to /home/jack/px_prostate_cancer_JA/QC3.lmiss.

#QCStep4
plink --bfile /home/jack/px_prostate_cancer_JA/QC2 --hardy --out /home/jack/px_prostate_cancer_JA/QC4
PLINK v1.90b4.3 64-bit (9 May 2017)            www.cog-genomics.org/plink/1.9/
(C) 2005-2017 Shaun Purcell, Christopher Chang   GNU General Public License v3
Error: Failed to open /home/jack/px_prostate_cancer_JA/QC4.log.  Try changing the --out parameter.
jack@wheelerlab1:~/px_prostate_cancer_JA$ plink --bfile /home/jack/px_prostate_cancer_JA/QC2 --hardy --out /home/jack/px_prostate_cancer_JA/QC4
PLINK v1.90b4.3 64-bit (9 May 2017)            www.cog-genomics.org/plink/1.9/
(C) 2005-2017 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to /home/jack/px_prostate_cancer_JA/QC4.log.
Options in effect:
  --bfile /home/jack/px_prostate_cancer_JA/QC2
  --hardy
  --out /home/jack/px_prostate_cancer_JA/QC4

64070 MB RAM detected; reserving 32035 MB for main workspace.
541127 variants loaded from .bim file.
1934 people (1934 males, 0 females) loaded from .fam.
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 1934 founders and 0 nonfounders present.
Calculating allele frequencies... done.
Warning: 3118 het. haploid genotypes present (see
/home/jack/px_prostate_cancer_JA/QC4.hh ); many commands treat these as
missing.
Total genotyping rate is 0.999546.
--hardy: Writing Hardy-Weinberg report (founders only) to
/home/jack/px_prostate_cancer_JA/QC4.hwe ... done.

#QCStep5a
plink --bfile /home/jack/px_prostate_cancer_JA/QC2 --indep-pairwise 50 5 0.3 --out /home/jack/px_prostate_cancer_JA/QC5a
PLINK v1.90b4.3 64-bit (9 May 2017)            www.cog-genomics.org/plink/1.9/
(C) 2005-2017 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to /home/jack/px_prostate_cancer_JA/QC5a.log.
Options in effect:
  --bfile /home/jack/px_prostate_cancer_JA/QC2
  --indep-pairwise 50 5 0.3
  --out /home/jack/px_prostate_cancer_JA/QC5a

64070 MB RAM detected; reserving 32035 MB for main workspace.
541127 variants loaded from .bim file.
1934 people (1934 males, 0 females) loaded from .fam.
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 1934 founders and 0 nonfounders present.
Calculating allele frequencies... done.
Warning: 3118 het. haploid genotypes present (see
/home/jack/px_prostate_cancer_JA/QC5a.hh ); many commands treat these as
missing.
Total genotyping rate is 0.999546.
541127 variants and 1934 people pass filters and QC.
Note: No phenotypes present.
--indep-pairwise: Ignoring 116 chromosome 0 variants.
Pruned 29465 variants from chromosome 1, leaving 12112.
Pruned 32347 variants from chromosome 2, leaving 11712.
Pruned 26419 variants from chromosome 3, leaving 10143.
Pruned 23012 variants from chromosome 4, leaving 9003.
Pruned 23673 variants from chromosome 5, leaving 9265.
Pruned 25906 variants from chromosome 6, leaving 9319.
Pruned 20850 variants from chromosome 7, leaving 8330.
Pruned 22217 variants from chromosome 8, leaving 7786.
Pruned 18493 variants from chromosome 9, leaving 7298.
Pruned 20355 variants from chromosome 10, leaving 7958.
Pruned 19083 variants from chromosome 11, leaving 7214.
Pruned 18702 variants from chromosome 12, leaving 7652.
Pruned 14470 variants from chromosome 13, leaving 5776.
Pruned 12590 variants from chromosome 14, leaving 5166.
Pruned 11221 variants from chromosome 15, leaving 4871.
Pruned 11191 variants from chromosome 16, leaving 5166.
Pruned 9273 variants from chromosome 17, leaving 4837.
Pruned 11213 variants from chromosome 18, leaving 4961.
Pruned 5704 variants from chromosome 19, leaving 3559.
Pruned 9352 variants from chromosome 20, leaving 4346.
Pruned 5478 variants from chromosome 21, leaving 2459.
Pruned 5518 variants from chromosome 22, leaving 2671.
Pruned 9468 variants from chromosome 23, leaving 3392.
Pruned 4 variants from chromosome 24, leaving 3.
Pruned 1 variant from chromosome 25, leaving 7.
Pruning complete.  386005 of 541011 variants removed.
Marker lists written to /home/jack/px_prostate_cancer_JA/QC5a.prune.in and
/home/jack/px_prostate_cancer_JA/QC5a.prune.out .

#QCStep5b
plink --bfile /home/jack/px_prostate_cancer_JA/QC2 --extract /home/jack/px_prostate_cancer_JA/QC5a.prune.in --genome --out /home/jack/px_prostate_cancer_JA/QC5b
PLINK v1.90b4.3 64-bit (9 May 2017)            www.cog-genomics.org/plink/1.9/
(C) 2005-2017 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to /home/jack/px_prostate_cancer_JA/QC5b.log.
Options in effect:
  --bfile /home/jack/px_prostate_cancer_JA/QC2
  --extract /home/jack/px_prostate_cancer_JA/QC5a.prune.in
  --genome
  --out /home/jack/px_prostate_cancer_JA/QC5b

64070 MB RAM detected; reserving 32035 MB for main workspace.
541127 variants loaded from .bim file.
1934 people (1934 males, 0 females) loaded from .fam.
--extract: 155006 variants remaining.
Using up to 11 threads (change this with --threads).
Before main variant filters, 1934 founders and 0 nonfounders present.
Calculating allele frequencies... done.
Warning: 839 het. haploid genotypes present (see
/home/jack/px_prostate_cancer_JA/QC5b.hh ); many commands treat these as
missing.
Total genotyping rate is 0.999544.
155006 variants and 1934 people pass filters and QC.
Note: No phenotypes present.
Excluding 3395 variants on non-autosomes from IBD calculation.
IBD calculations complete.
Finished writing /home/jack/px_prostate_cancer_JA/QC5b.genome .

#QCStepb1
plink --bfile /home/jack/px_prostate_cancer_JA/QC2 --extract /home/jack/px_prostate_cancer_JA/QC5a.prune.in --rel-cutoff 0.05 --make-bed --out /home/jack/px_prostate_cancer_JA/QC5b1
PLINK v1.90b4.3 64-bit (9 May 2017)            www.cog-genomics.org/plink/1.9/
(C) 2005-2017 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to /home/jack/px_prostate_cancer_JA/QC5b1.log.
Options in effect:
  --bfile /home/jack/px_prostate_cancer_JA/QC2
  --extract /home/jack/px_prostate_cancer_JA/QC5a.prune.in
  --make-bed
  --out /home/jack/px_prostate_cancer_JA/QC5b1
  --rel-cutoff 0.05

64070 MB RAM detected; reserving 32035 MB for main workspace.
541127 variants loaded from .bim file.
1934 people (1934 males, 0 females) loaded from .fam.
--extract: 155006 variants remaining.
Using up to 11 threads (change this with --threads).
Before main variant filters, 1934 founders and 0 nonfounders present.
Calculating allele frequencies... done.
Warning: 839 het. haploid genotypes present (see
/home/jack/px_prostate_cancer_JA/QC5b1.hh ); many commands treat these as
missing.
Total genotyping rate is 0.999544.
155006 variants and 1934 people pass filters and QC (before --rel-cutoff).
Note: No phenotypes present.
Excluding 3395 variants on non-autosomes from relationship matrix calc.
Relationship matrix calculation complete.
167 people excluded by --rel-cutoff.
Remaining sample IDs written to /home/jack/px_prostate_cancer_JA/QC5b1.rel.id .
--make-bed to /home/jack/px_prostate_cancer_JA/QC5b1.bed +
/home/jack/px_prostate_cancer_JA/QC5b1.bim +
/home/jack/px_prostate_cancer_JA/QC5b1.fam ... done.

#QCStepb2
plink --bfile /home/jack/px_prostate_cancer_JA/QC5b1 --extract /home/jack/px_prostate_cancer_JA/QC5a.prune.in --genome --out /home/jack/px_prostate_cancer_JA/QC5b2
PLINK v1.90b4.3 64-bit (9 May 2017)            www.cog-genomics.org/plink/1.9/
(C) 2005-2017 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to /home/jack/px_prostate_cancer_JA/QC5b2.log.
Options in effect:
  --bfile /home/jack/px_prostate_cancer_JA/QC5b1
  --extract /home/jack/px_prostate_cancer_JA/QC5a.prune.in
  --genome
  --out /home/jack/px_prostate_cancer_JA/QC5b2

64070 MB RAM detected; reserving 32035 MB for main workspace.
155006 variants loaded from .bim file.
1767 people (1767 males, 0 females) loaded from .fam.
--extract: 155006 variants remaining.
Using up to 11 threads (change this with --threads).
Before main variant filters, 1767 founders and 0 nonfounders present.
Calculating allele frequencies... done.
Warning: 773 het. haploid genotypes present (see
/home/jack/px_prostate_cancer_JA/QC5b2.hh ); many commands treat these as
missing.
Total genotyping rate is 0.999562.
155006 variants and 1767 people pass filters and QC.
Note: No phenotypes present.
Excluding 3395 variants on non-autosomes from IBD calculation.
IBD calculations complete.
Finished writing /home/jack/px_prostate_cancer_JA/QC5b2.genome .

#Use following commands to change data in QC2 and get rid of sex chromosomes

awk '{ if ($1 >= 1 && $1 <= 22) print $2 }' QC2.bim > snp.txt

plink --bfile /home/jack/px_prostate_cancer_JA/QC2 --extract snp.txt --make-bed --out /home/jack/px_prostate_cancer_JA/QC2a
PLINK v1.90b4.3 64-bit (9 May 2017)            www.cog-genomics.org/plink/1.9/
(C) 2005-2017 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to /home/jack/px_prostate_cancer_JA/QC2a.log.
Options in effect:
  --bfile /home/jack/px_prostate_cancer_JA/QC2
  --extract snp.txt
  --make-bed
  --out /home/jack/px_prostate_cancer_JA/QC2a

64070 MB RAM detected; reserving 32035 MB for main workspace.
541127 variants loaded from .bim file.
1934 people (1934 males, 0 females) loaded from .fam.
--extract: 528136 variants remaining.
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 1934 founders and 0 nonfounders present.
Calculating allele frequencies... done.
Total genotyping rate is 0.999547.
528136 variants and 1934 people pass filters and QC.
Note: No phenotypes present.
--make-bed to /home/jack/px_prostate_cancer_JA/QC2a.bed +
/home/jack/px_prostate_cancer_JA/QC2a.bim +
/home/jack/px_prostate_cancer_JA/QC2a.fam ... done.

#QCStep3 Again
plink --bfile /home/jack/px_prostate_cancer_JA/QC2a --missing --out /home/jack/px_prostate_cancer_JA/QC3
PLINK v1.90b4.3 64-bit (9 May 2017)            www.cog-genomics.org/plink/1.9/
(C) 2005-2017 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to /home/jack/px_prostate_cancer_JA/QC3.log.
Options in effect:
  --bfile /home/jack/px_prostate_cancer_JA/QC2a
  --missing
  --out /home/jack/px_prostate_cancer_JA/QC3

64070 MB RAM detected; reserving 32035 MB for main workspace.
528136 variants loaded from .bim file.
1934 people (1934 males, 0 females) loaded from .fam.
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 1934 founders and 0 nonfounders present.
Calculating allele frequencies... done.
Total genotyping rate is 0.999547.
--missing: Sample missing data report written to
/home/jack/px_prostate_cancer_JA/QC3.imiss, and variant-based missing data
report written to /home/jack/px_prostate_cancer_JA/QC3.lmiss.

#QCStep4 Again
plink --bfile /home/jack/px_prostate_cancer_JA/QC2a --hardy --out /home/jack/px_prostate_cancer_JA/QC4
PLINK v1.90b4.3 64-bit (9 May 2017)            www.cog-genomics.org/plink/1.9/
(C) 2005-2017 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to /home/jack/px_prostate_cancer_JA/QC4.log.
Options in effect:
  --bfile /home/jack/px_prostate_cancer_JA/QC2a
  --hardy
  --out /home/jack/px_prostate_cancer_JA/QC4

64070 MB RAM detected; reserving 32035 MB for main workspace.
528136 variants loaded from .bim file.
1934 people (1934 males, 0 females) loaded from .fam.
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 1934 founders and 0 nonfounders present.
Calculating allele frequencies... done.
Total genotyping rate is 0.999547.
--hardy: Writing Hardy-Weinberg report (founders only) to
/home/jack/px_prostate_cancer_JA/QC4.hwe ... done.

#QCStep5a Again
plink --bfile /home/jack/px_prostate_cancer_JA/QC2a --indep-pairwise 50 5 0.3 --out /home/jack/px_prostate_cancer_JA/QC5a
PLINK v1.90b4.3 64-bit (9 May 2017)            www.cog-genomics.org/plink/1.9/
(C) 2005-2017 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to /home/jack/px_prostate_cancer_JA/QC5a.log.
Options in effect:
  --bfile /home/jack/px_prostate_cancer_JA/QC2a
  --indep-pairwise 50 5 0.3
  --out /home/jack/px_prostate_cancer_JA/QC5a

64070 MB RAM detected; reserving 32035 MB for main workspace.
528136 variants loaded from .bim file.
1934 people (1934 males, 0 females) loaded from .fam.
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 1934 founders and 0 nonfounders present.
Calculating allele frequencies... done.
Total genotyping rate is 0.999547.
528136 variants and 1934 people pass filters and QC.
Note: No phenotypes present.
Pruned 29465 variants from chromosome 1, leaving 12112.
Pruned 32347 variants from chromosome 2, leaving 11712.
Pruned 26419 variants from chromosome 3, leaving 10143.
Pruned 23012 variants from chromosome 4, leaving 9003.
Pruned 23673 variants from chromosome 5, leaving 9265.
Pruned 25906 variants from chromosome 6, leaving 9319.
Pruned 20850 variants from chromosome 7, leaving 8330.
Pruned 22217 variants from chromosome 8, leaving 7786.
Pruned 18493 variants from chromosome 9, leaving 7298.
Pruned 20355 variants from chromosome 10, leaving 7958.
Pruned 19083 variants from chromosome 11, leaving 7214.
Pruned 18702 variants from chromosome 12, leaving 7652.
Pruned 14470 variants from chromosome 13, leaving 5776.
Pruned 12590 variants from chromosome 14, leaving 5166.
Pruned 11221 variants from chromosome 15, leaving 4871.
Pruned 11191 variants from chromosome 16, leaving 5166.
Pruned 9273 variants from chromosome 17, leaving 4837.
Pruned 11213 variants from chromosome 18, leaving 4961.
Pruned 5704 variants from chromosome 19, leaving 3559.
Pruned 9352 variants from chromosome 20, leaving 4346.
Pruned 5478 variants from chromosome 21, leaving 2459.
Pruned 5518 variants from chromosome 22, leaving 2671.
Pruning complete.  376532 of 528136 variants removed.
Marker lists written to /home/jack/px_prostate_cancer_JA/QC5a.prune.in and
/home/jack/px_prostate_cancer_JA/QC5a.prune.out .

#QCStep5b Again
plink --bfile /home/jack/px_prostate_cancer_JA/QC2a --extract /home/jack/px_prostate_cancer_JA/QC5a.prune.in --genome --out /home/jack/px_prostate_cancer_JA/QC5b
PLINK v1.90b4.3 64-bit (9 May 2017)            www.cog-genomics.org/plink/1.9/
(C) 2005-2017 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to /home/jack/px_prostate_cancer_JA/QC5b.log.
Options in effect:
  --bfile /home/jack/px_prostate_cancer_JA/QC2a
  --extract /home/jack/px_prostate_cancer_JA/QC5a.prune.in
  --genome
  --out /home/jack/px_prostate_cancer_JA/QC5b

64070 MB RAM detected; reserving 32035 MB for main workspace.
528136 variants loaded from .bim file.
1934 people (1934 males, 0 females) loaded from .fam.
--extract: 151604 variants remaining.
Using up to 11 threads (change this with --threads).
Before main variant filters, 1934 founders and 0 nonfounders present.
Calculating allele frequencies... done.
Total genotyping rate is 0.999545.
151604 variants and 1934 people pass filters and QC.
Note: No phenotypes present.
IBD calculations complete.
Finished writing /home/jack/px_prostate_cancer_JA/QC5b.genome .

#QCStep5b1
plink --bfile /home/jack/px_prostate_cancer_JA/QC2a --extract /home/jack/px_prostate_cancer_JA/QC5a.prune.in --rel-cutoff 0.05 --make-bed --out /home/jack/px_prostate_cancer_JA/QC5b1
PLINK v1.90b4.3 64-bit (9 May 2017)            www.cog-genomics.org/plink/1.9/
(C) 2005-2017 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to /home/jack/px_prostate_cancer_JA/QC5b1.log.
Options in effect:
  --bfile /home/jack/px_prostate_cancer_JA/QC2a
  --extract /home/jack/px_prostate_cancer_JA/QC5a.prune.in
  --make-bed
  --out /home/jack/px_prostate_cancer_JA/QC5b1
  --rel-cutoff 0.05

64070 MB RAM detected; reserving 32035 MB for main workspace.
528136 variants loaded from .bim file.
1934 people (1934 males, 0 females) loaded from .fam.
--extract: 151604 variants remaining.
Using up to 11 threads (change this with --threads).
Before main variant filters, 1934 founders and 0 nonfounders present.
Calculating allele frequencies... done.
Total genotyping rate is 0.999545.
151604 variants and 1934 people pass filters and QC (before --rel-cutoff).
Note: No phenotypes present.
Relationship matrix calculation complete.
167 people excluded by --rel-cutoff.
Remaining sample IDs written to /home/jack/px_prostate_cancer_JA/QC5b1.rel.id .
--make-bed to /home/jack/px_prostate_cancer_JA/QC5b1.bed +
/home/jack/px_prostate_cancer_JA/QC5b1.bim +
/home/jack/px_prostate_cancer_JA/QC5b1.fam ... done.

#QCStep5b2
plink --bfile /home/jack/px_prostate_cancer_JA/QC5b1 --extract /home/jack/px_prostate_cancer_JA/QC5a.prune.in --genome --out /home/jack/px_prostate_cancer_JA/QC5b2
PLINK v1.90b4.3 64-bit (9 May 2017)            www.cog-genomics.org/plink/1.9/
(C) 2005-2017 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to /home/jack/px_prostate_cancer_JA/QC5b2.log.
Options in effect:
  --bfile /home/jack/px_prostate_cancer_JA/QC5b1
  --extract /home/jack/px_prostate_cancer_JA/QC5a.prune.in
  --genome
  --out /home/jack/px_prostate_cancer_JA/QC5b2

64070 MB RAM detected; reserving 32035 MB for main workspace.
151604 variants loaded from .bim file.
1767 people (1767 males, 0 females) loaded from .fam.
--extract: 151604 variants remaining.
Using up to 11 threads (change this with --threads).
Before main variant filters, 1767 founders and 0 nonfounders present.
Calculating allele frequencies... done.
Total genotyping rate is 0.999563.
151604 variants and 1767 people pass filters and QC.
Note: No phenotypes present.
IBD calculations complete.
Finished writing /home/jack/px_prostate_cancer_JA/QC5b2.genome .

#This command is just to check how many SNPs are not at significance threshold
plink --bfile /home/jack/px_prostate_cancer_JA/QC2a --hwe 0.01 --make-bed --out  /home/jack/px_prostate_cancer_JA/test
PLINK v1.90b4.3 64-bit (9 May 2017)            www.cog-genomics.org/plink/1.9/
(C) 2005-2017 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to /home/jack/px_prostate_cancer_JA/test.log.
Options in effect:
  --bfile /home/jack/px_prostate_cancer_JA/QC2a
  --hwe 0.01
  --make-bed
  --out /home/jack/px_prostate_cancer_JA/test

64070 MB RAM detected; reserving 32035 MB for main workspace.
528136 variants loaded from .bim file.
1934 people (1934 males, 0 females) loaded from .fam.
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 1934 founders and 0 nonfounders present.
Calculating allele frequencies... done.
Total genotyping rate is 0.999547.
--hwe: 10005 variants removed due to Hardy-Weinberg exact test.
518131 variants and 1934 people pass filters and QC.
Note: No phenotypes present.
--make-bed to /home/jack/px_prostate_cancer_JA/test.bed +
/home/jack/px_prostate_cancer_JA/test.bim +
/home/jack/px_prostate_cancer_JA/test.fam ... done.

#QCStepc
plink --bfile /home/jack/px_prostate_cancer_JA/QC5b1 --het --out /home/jack/px_prostate_cancer_JA/QC5c
PLINK v1.90b4.3 64-bit (9 May 2017)            www.cog-genomics.org/plink/1.9/
(C) 2005-2017 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to /home/jack/px_prostate_cancer_JA/QC5c.log.
Options in effect:
  --bfile /home/jack/px_prostate_cancer_JA/QC5b1
  --het
  --out /home/jack/px_prostate_cancer_JA/QC5c

64070 MB RAM detected; reserving 32035 MB for main workspace.
151604 variants loaded from .bim file.
1767 people (1767 males, 0 females) loaded from .fam.
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 1767 founders and 0 nonfounders present.
Calculating allele frequencies... done.
Total genotyping rate is 0.999563.
151604 variants and 1767 people pass filters and QC.
Note: No phenotypes present.
--het: 137978 variants scanned, report written to
/home/jack/px_prostate_cancer_JA/QC5c.het .

#This is to help make a new imiss plot in 8_QCPLOTS_JA
plink --bfile /home/jack/px_prostate_cancer_JA/QC5b1 --missing --out /home/jack/px_prostate_cancer_JA/QC5b3
PLINK v1.90b4.3 64-bit (9 May 2017)            www.cog-genomics.org/plink/1.9/
(C) 2005-2017 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to /home/jack/px_prostate_cancer_JA/QC5b3.log.
Options in effect:
  --bfile /home/jack/px_prostate_cancer_JA/QC5b1
  --missing
  --out /home/jack/px_prostate_cancer_JA/QC5b3

64070 MB RAM detected; reserving 32035 MB for main workspace.
151604 variants loaded from .bim file.
1767 people (1767 males, 0 females) loaded from .fam.
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 1767 founders and 0 nonfounders present.
Calculating allele frequencies... done.
Total genotyping rate is 0.999563.
--missing: Sample missing data report written to
/home/jack/px_prostate_cancer_JA/QC5b3.imiss, and variant-based missing data
report written to /home/jack/px_prostate_cancer_JA/QC5b3.lmiss.

#Liftover Steps

nano newfile 
#paste all python commands into newfile from http://genome.sph.umich.edu/wiki/LiftMap.py

#change LIFTOVERBIN AND CHAIN
['LIFTOVERBIN'] = /usr/local/bin/liftOver
['CHAIN'] = /home/wheelerlab1/Data/liftOver_files/hg18ToHg19.over.chain.gz

#Now do the same thing to a new file and name it LiftMap.py
nano LiftMap.py 
#Change the two lines in the file again:
['LIFTOVERBIN'] = /usr/local/bin/liftOver
['CHAIN'] = /home/wheelerlab1/Data/liftOver_files/hg18ToHg19.over.chain.gz

plink --bfile QC5b1 --recode --out /home/jack/px_prostate_cancer_JA/newfile
PLINK v1.90b4.3 64-bit (9 May 2017)            www.cog-genomics.org/plink/1.9/
(C) 2005-2017 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to /home/jack/px_prostate_cancer_JA/newfile.log.
Options in effect:
  --bfile QC5b1
  --out /home/jack/px_prostate_cancer_JA/newfile
  --recode

64070 MB RAM detected; reserving 32035 MB for main workspace.
151604 variants loaded from .bim file.
1767 people (1767 males, 0 females) loaded from .fam.
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 1767 founders and 0 nonfounders present.
Calculating allele frequencies... done.
Total genotyping rate is 0.999563.
151604 variants and 1767 people pass filters and QC.
Note: No phenotypes present.
--recode ped to /home/jack/px_prostate_cancer_JA/newfile.ped +
/home/jack/px_prostate_cancer_JA/newfile.map ... done.

python LiftMap.py -m newfile.map -p newfile.ped -o new
SUCC:  map->bed succ
Reading liftover chains
Mapping coordinates
SUCC:  liftBed succ
SUCC:  bed->map succ
SUCC:  liftPed succ

plink --file new --make-bed --out hg19
PLINK v1.90b4.3 64-bit (9 May 2017)            www.cog-genomics.org/plink/1.9/
(C) 2005-2017 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to hg19.log.
Options in effect:
  --file new
  --make-bed
  --out hg19

64070 MB RAM detected; reserving 32035 MB for main workspace.
.ped scan complete (for binary autoconversion).
Performing single-pass .bed write (151586 variants, 1767 people).
--file: hg19-temporary.bed + hg19-temporary.bim + hg19-temporary.fam written.
151586 variants loaded from .bim file.
1767 people (1767 males, 0 females) loaded from .fam.
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 1767 founders and 0 nonfounders present.
Calculating allele frequencies... done.
Total genotyping rate is 0.999563.
151586 variants and 1767 people pass filters and QC.
Note: No phenotypes present.
--make-bed to hg19.bed + hg19.bim + hg19.fam ... done.

#QCStep6a
plink --bfile /home/jack/px_prostate_cancer_JA/hg19 --bmerge /home/wheelerlab1/Data/HAPMAP3_hg19/HM3_ASN_CEU_YRI_Unrelated_hg19_noAmbig.bed /home/wheelerlab1/Data/HAPMAP3_hg19/HM3_ASN_CEU_YRI_Unrelated_hg19_noAmbig.bim /home/wheelerlab1/Data/HAPMAP3_hg19/HM3_ASN_CEU_YRI_Unrelated_hg19_noAmbig.fam --make-bed --out /home/jack/px_prostate_cancer_JA/QC6a
PLINK v1.90b4.3 64-bit (9 May 2017)            www.cog-genomics.org/plink/1.9/
(C) 2005-2017 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to /home/jack/px_prostate_cancer_JA/QC6a.log.
Options in effect:
  --bfile /home/jack/px_prostate_cancer_JA/hg19
  --bmerge /home/wheelerlab1/Data/HAPMAP3_hg19/HM3_ASN_CEU_YRI_Unrelated_hg19_noAmbig.bed /home/wheelerlab1/Data/HAPMAP3_hg19/HM3_ASN_CEU_YRI_Unrelated_hg19_noAmbig.bim /home/wheelerlab1/Data/HAPMAP3_hg19/HM3_ASN_CEU_YRI_Unrelated_hg19_noAmbig.fam
  --make-bed
  --out /home/jack/px_prostate_cancer_JA/QC6a

64070 MB RAM detected; reserving 32035 MB for main workspace.
1767 people loaded from /home/jack/px_prostate_cancer_JA/hg19.fam.
391 people to be merged from
/home/wheelerlab1/Data/HAPMAP3_hg19/HM3_ASN_CEU_YRI_Unrelated_hg19_noAmbig.fam.
Of these, 391 are new, while 0 are present in the base dataset.
Warning: Multiple positions seen for variant 'rs1051740'.
Warning: Multiple positions seen for variant 'rs11928389'.
Warning: Multiple positions seen for variant 'rs6837562'.
151586 markers loaded from /home/jack/px_prostate_cancer_JA/hg19.bim.
1447224 markers to be merged from
/home/wheelerlab1/Data/HAPMAP3_hg19/HM3_ASN_CEU_YRI_Unrelated_hg19_noAmbig.bim.
Of these, 1297848 are new, while 149376 are present in the base dataset.
31 more multiple-position warnings: see log file.
Error: 74815 variants with 3+ alleles present.
* If you believe this is due to strand   inconsistency, try --flip with
  /home/jack/px_prostate_cancer_JA/QC6a-merge.missnp.
  (Warning: if this seems to work, strand errors involving SNPs with A/T or C/G
  alleles probably remain in your data.  If LD between nearby SNPs is high,
  --flip-scan should detect them.)
* If you are dealing with genuine multiallelic variants, we recommend exporting
  that subset of the data to VCF (via e.g. '--recode vcf'), merging with
  another tool/script, and then importing the result; PLINK is not yet suited
  to handling them.

#QCStep6b
plink --bfile /home/wheelerlab1/Data/HAPMAP3_hg19/HM3_ASN_CEU_YRI_Unrelated_hg19_noAmbig --exclude /home/jack/px_prostate_cancer_JA/QC6a-merge.missnp --make-bed --out /home/jack/px_prostate_cancer_JA/QC6b
PLINK v1.90b4.3 64-bit (9 May 2017)            www.cog-genomics.org/plink/1.9/
(C) 2005-2017 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to /home/jack/px_prostate_cancer_JA/QC6b.log.
Options in effect:
  --bfile /home/wheelerlab1/Data/HAPMAP3_hg19/HM3_ASN_CEU_YRI_Unrelated_hg19_noAmbig
  --exclude /home/jack/px_prostate_cancer_JA/QC6a-merge.missnp
  --make-bed
  --out /home/jack/px_prostate_cancer_JA/QC6b

64070 MB RAM detected; reserving 32035 MB for main workspace.
1447224 variants loaded from .bim file.
391 people (197 males, 194 females) loaded from .fam.
391 phenotype values loaded from .fam.
--exclude: 1372409 variants remaining.
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 391 founders and 0 nonfounders present.
Calculating allele frequencies... done.
Total genotyping rate is 0.850712.
1372409 variants and 391 people pass filters and QC.
Among remaining phenotypes, 0 are cases and 391 are controls.
--make-bed to /home/jack/px_prostate_cancer_JA/QC6b.bed +
/home/jack/px_prostate_cancer_JA/QC6b.bim +
/home/jack/px_prostate_cancer_JA/QC6b.fam ... done.

#QCStep6c
plink --bfile /home/jack/px_prostate_cancer_JA/hg19 --bmerge /home/jack/px_prostate_cancer_JA/QC6b.bed /home/jack/px_prostate_cancer_JA/QC6b.bim /home/jack/px_prostate_cancer_JA/QC6b.fam --make-bed --out /home/jack/px_prostate_cancer_JA/QC6c
PLINK v1.90b4.3 64-bit (9 May 2017)            www.cog-genomics.org/plink/1.9/
(C) 2005-2017 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to /home/jack/px_prostate_cancer_JA/QC6c.log.
Options in effect:
  --bfile /home/jack/px_prostate_cancer_JA/hg19
  --bmerge /home/jack/px_prostate_cancer_JA/QC6b.bed /home/jack/px_prostate_cancer_JA/QC6b.bim /home/jack/px_prostate_cancer_JA/QC6b.fam
  --make-bed
  --out /home/jack/px_prostate_cancer_JA/QC6c

64070 MB RAM detected; reserving 32035 MB for main workspace.
1767 people loaded from /home/jack/px_prostate_cancer_JA/hg19.fam.
391 people to be merged from /home/jack/px_prostate_cancer_JA/QC6b.fam.
Of these, 391 are new, while 0 are present in the base dataset.
Warning: Multiple positions seen for variant 'rs11928389'.
Warning: Multiple positions seen for variant 'rs7383287'.
Warning: Multiple positions seen for variant 'rs7796556'.
151586 markers loaded from /home/jack/px_prostate_cancer_JA/hg19.bim.
1372409 markers to be merged from /home/jack/px_prostate_cancer_JA/QC6b.bim.
Of these, 1297848 are new, while 74561 are present in the base dataset.
12 more multiple-position warnings: see log file.
Warning: Variants 'rs7555212' and 'AFFX-SNP_6564577__rs7555212' have the same
position.
Warning: Variants 'rs10915322' and 'AFFX-SNP_6869948__rs10915322' have the same
position.
Warning: Variants 'rs9439505' and 'AFFX-SNP_4600__rs9439505' have the same
position.
2432 more same-position warnings: see log file.
Performing single-pass merge (2158 people, 1449434 variants).
Merged fileset written to /home/jack/px_prostate_cancer_JA/QC6c-merge.bed +
/home/jack/px_prostate_cancer_JA/QC6c-merge.bim +
/home/jack/px_prostate_cancer_JA/QC6c-merge.fam .
1449434 variants loaded from .bim file.
2158 people (1964 males, 194 females) loaded from .fam.
391 phenotype values loaded from .fam.
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 2158 founders and 0 nonfounders present.
Calculating allele frequencies... done.
Total genotyping rate is 0.231543.
1449434 variants and 2158 people pass filters and QC.
Among remaining phenotypes, 0 are cases and 391 are controls.  (1767 phenotypes
are missing.)
--make-bed to /home/jack/px_prostate_cancer_JA/QC6c.bed +
/home/jack/px_prostate_cancer_JA/QC6c.bim +
/home/jack/px_prostate_cancer_JA/QC6c.fam ... done.

#QCStep6d
plink --bfile /home/jack/px_prostate_cancer_JA/QC6c --geno 0.01 --maf 0.05 --make-bed --out /home/jack/px_prostate_cancer_JA/QC6d1
PLINK v1.90b4.3 64-bit (9 May 2017)            www.cog-genomics.org/plink/1.9/
(C) 2005-2017 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to /home/jack/px_prostate_cancer_JA/QC6d1.log.
Options in effect:
  --bfile /home/jack/px_prostate_cancer_JA/QC6c
  --geno 0.01
  --maf 0.05
  --make-bed
  --out /home/jack/px_prostate_cancer_JA/QC6d1

64070 MB RAM detected; reserving 32035 MB for main workspace.
1449434 variants loaded from .bim file.
2158 people (1964 males, 194 females) loaded from .fam.
391 phenotype values loaded from .fam.
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 2158 founders and 0 nonfounders present.
Calculating allele frequencies... done.
Total genotyping rate is 0.231543.
1392920 variants removed due to missing genotype data (--geno).
5013 variants removed due to minor allele threshold(s)
(--maf/--max-maf/--mac/--max-mac).
51501 variants and 2158 people pass filters and QC.
Among remaining phenotypes, 0 are cases and 391 are controls.  (1767 phenotypes
are missing.)
--make-bed to /home/jack/px_prostate_cancer_JA/QC6d1.bed +
/home/jack/px_prostate_cancer_JA/QC6d1.bim +
/home/jack/px_prostate_cancer_JA/QC6d1.fam ... done.

#QCStep6e1
plink --bfile /home/jack/px_prostate_cancer_JA/QC6d1 --indep-pairwise 50 5 0.3 --recode --out /home/jack/px_prostate_cancer_JA/QC6e1
PLINK v1.90b4.3 64-bit (9 May 2017)            www.cog-genomics.org/plink/1.9/
(C) 2005-2017 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to /home/jack/px_prostate_cancer_JA/QC6e1.log.
Options in effect:
  --bfile /home/jack/px_prostate_cancer_JA/QC6d1
  --indep-pairwise 50 5 0.3
  --out /home/jack/px_prostate_cancer_JA/QC6e1
  --recode

64070 MB RAM detected; reserving 32035 MB for main workspace.
51501 variants loaded from .bim file.
2158 people (1964 males, 194 females) loaded from .fam.
391 phenotype values loaded from .fam.
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 2158 founders and 0 nonfounders present.
Calculating allele frequencies... done.
Total genotyping rate is 0.999202.
51501 variants and 2158 people pass filters and QC.
Among remaining phenotypes, 0 are cases and 391 are controls.  (1767 phenotypes
are missing.)
--recode ped to /home/jack/px_prostate_cancer_JA/QC6e1.ped +
/home/jack/px_prostate_cancer_JA/QC6e1.map ... done.
Pruned 62 variants from chromosome 1, leaving 3991.
Pruned 92 variants from chromosome 2, leaving 3824.
Pruned 68 variants from chromosome 3, leaving 3373.
Pruned 49 variants from chromosome 4, leaving 3027.
Pruned 63 variants from chromosome 5, leaving 3081.
Pruned 48 variants from chromosome 6, leaving 2982.
Pruned 44 variants from chromosome 7, leaving 2712.
Pruned 54 variants from chromosome 8, leaving 2566.
Pruned 27 variants from chromosome 9, leaving 2439.
Pruned 46 variants from chromosome 10, leaving 2605.
Pruned 48 variants from chromosome 11, leaving 2409.
Pruned 42 variants from chromosome 12, leaving 2515.
Pruned 24 variants from chromosome 13, leaving 1923.
Pruned 26 variants from chromosome 14, leaving 1759.
Pruned 31 variants from chromosome 15, leaving 1703.
Pruned 30 variants from chromosome 16, leaving 1787.
Pruned 30 variants from chromosome 17, leaving 1697.
Pruned 32 variants from chromosome 18, leaving 1703.
Pruned 15 variants from chromosome 19, leaving 1290.
Pruned 25 variants from chromosome 20, leaving 1484.
Pruned 11 variants from chromosome 21, leaving 857.
Pruned 18 variants from chromosome 22, leaving 889.
Pruning complete.  885 of 51501 variants removed.
Marker lists written to /home/jack/px_prostate_cancer_JA/QC6e1.prune.in and
/home/jack/px_prostate_cancer_JA/QC6e1.prune.out .



#QCStep6f
awk '{print $1w,$2,$3,$4,$5,1}' /home/jack/px_prostate_cancer_JA/QC6d1.fam > /home/jack/px_prostate_cancer_JA/QC6e1.fam
#QCStep6g
perl /home/wheelerlab1/Data/GWAS_QC_scripts/make_par_file.pl /home/jack/px_prostate_cancer_JA/QC6e1 0 > /home/jack/px_prostate_cancer_JA/QC6f1.par
#QCStep6h
Go to 10_SmartPCA_JA for PCA

#SmartPCA to be run without data merged to hapmap
plink --bfile /home/jack/px_prostate_cancer_JA/hg19 --geno 0.01 --maf 0.05 --make-bed --out /home/jack/px_prostate_cancer_JA/newpca
PLINK v1.90b4.3 64-bit (9 May 2017)            www.cog-genomics.org/plink/1.9/
(C) 2005-2017 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to /home/jack/px_prostate_cancer_JA/newpca.log.
Options in effect:
  --bfile /home/jack/px_prostate_cancer_JA/hg19
  --geno 0.01
  --maf 0.05
  --make-bed
  --out /home/jack/px_prostate_cancer_JA/newpca

64070 MB RAM detected; reserving 32035 MB for main workspace.
151586 variants loaded from .bim file.
1767 people (1767 males, 0 females) loaded from .fam.
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 1767 founders and 0 nonfounders present.
Calculating allele frequencies... done.
Total genotyping rate is 0.999563.
53 variants removed due to missing genotype data (--geno).
44259 variants removed due to minor allele threshold(s)
(--maf/--max-maf/--mac/--max-mac).
107274 variants and 1767 people pass filters and QC.
Note: No phenotypes present.
--make-bed to /home/jack/px_prostate_cancer_JA/newpca.bed +
/home/jack/px_prostate_cancer_JA/newpca.bim +
/home/jack/px_prostate_cancer_JA/newpca.fam ... done.

plink --bfile /home/jack/px_prostate_cancer_JA/newpca --indep-pairwise 50 5 0.3 --recode --out /home/jack/px_prostate_cancer_JA/newpca2
PLINK v1.90b4.3 64-bit (9 May 2017)            www.cog-genomics.org/plink/1.9/
(C) 2005-2017 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to /home/jack/px_prostate_cancer_JA/newpca2.log.
Options in effect:
  --bfile /home/jack/px_prostate_cancer_JA/newpca
  --indep-pairwise 50 5 0.3
  --out /home/jack/px_prostate_cancer_JA/newpca2
  --recode

64070 MB RAM detected; reserving 32035 MB for main workspace.
107274 variants loaded from .bim file.
1767 people (1767 males, 0 females) loaded from .fam.
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 1767 founders and 0 nonfounders present.
Calculating allele frequencies... done.
Total genotyping rate is 0.999556.
107274 variants and 1767 people pass filters and QC.
Note: No phenotypes present.
--recode ped to /home/jack/px_prostate_cancer_JA/newpca2.ped +
/home/jack/px_prostate_cancer_JA/newpca2.map ... done.
Pruned 86 variants from chromosome 1, leaving 8426.
Pruned 116 variants from chromosome 2, leaving 7970.
Pruned 87 variants from chromosome 3, leaving 7089.
Pruned 64 variants from chromosome 4, leaving 6381.
Pruned 80 variants from chromosome 5, leaving 6420.
Pruned 103 variants from chromosome 6, leaving 6257.
Pruned 76 variants from chromosome 7, leaving 5743.
Pruned 68 variants from chromosome 8, leaving 5359.
Pruned 61 variants from chromosome 9, leaving 5152.
Pruned 54 variants from chromosome 10, leaving 5531.
Pruned 51 variants from chromosome 11, leaving 5084.
Pruned 69 variants from chromosome 12, leaving 5331.
Pruned 33 variants from chromosome 13, leaving 3964.
Pruned 33 variants from chromosome 14, leaving 3598.
Pruned 30 variants from chromosome 15, leaving 3555.
Pruned 29 variants from chromosome 16, leaving 3790.
Pruned 20 variants from chromosome 17, leaving 3553.
Pruned 34 variants from chromosome 18, leaving 3517.
Pruned 16 variants from chromosome 19, leaving 2668.
Pruned 22 variants from chromosome 20, leaving 3067.
Pruned 16 variants from chromosome 21, leaving 1760.
Pruned 22 variants from chromosome 22, leaving 1889.
Pruning complete.  1170 of 107274 variants removed.
Marker lists written to /home/jack/px_prostate_cancer_JA/newpca2.prune.in and
/home/jack/px_prostate_cancer_JA/newpca2.prune.out .

awk '{print $1w,$2,$3,$4,$5,1}' /home/jack/px_prostate_cancer_JA/newpca.fam > /home/jack/px_prostate_cancer_JA/newpca2.fam

perl /home/wheelerlab1/Data/GWAS_QC_scripts/make_par_file.pl /home/jack/px_prostate_cancer_JA/newpca2 0 > /home/jack/px_prostate_cancer_JA/newpca3.par

smartpca -p /home/jack/px_prostate_cancer_JA/newpca3.par
	#Takes 2 minutes
